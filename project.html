<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
    <title>
      Google Visualization API Sample
    </title>
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
	<script type="text/javascript">
      google.load('visualization', '1', {packages: ['corechart']});
	   google.load('visualization', '1', {packages: ['motionchart']});
	    google.load('visualization', '1.0', {packages:['controls']});
    </script>
    
    <script type="text/javascript">
    var LineChart1;
google.setOnLoadCallback(drawVisualization);
    function drawVisualization()
	{
     drawGraph1();
	 
	
    }
	
	
	//Draw Line Graph
	function drawGraph1()
	{
	 // To see the data that this visualization uses, browse to
      // https://docs.google.com/spreadsheet/ccc?key=0As-rWerCrohAdE00d29lTHRDUnFlejBJVFg2VjM3SUE&usp=sharing#gid=0
      var query = new google.visualization.Query('https://docs.google.com/spreadsheet/ccc?key=0As-rWerCrohAdE00d29lTHRDUnFlejBJVFg2VjM3SUE&usp=sharing#gid=0');
	
      //Data FOR LINEGRAPH
	  
	  // Apply query language statement.
      query.setQuery('SELECT * WHERE B<2003 Order BY B  ');
      
      // Send the query with a callback function.
      query.send(handleQueryResponse);
	  function handleQueryResponse(response) 
	  {
      if (response.isError()) 
	  {
        alert('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
        return;
      }
    

      var data = response.getDataTable();
	 
	 
      var dashboard= new google.visualization.Dashboard(document.getElementById('dashboard_div')); 
	  LineChart1 = new google.visualization.ChartWrapper(
	  {
	  'chartType':'LineChart',
	  'containerId':'visualization1_div',
	  'options':{
		'title': 'Year Vs Land Area',
		'colors': ['#FFD700', '#C0C0C0', '#8C7853'],
		// This line makes the entire category's tooltip active.
		'focusTarget': 'category',
		// Use an HTML tooltip.
		'tooltip': { isHtml: true },
		'vAxis': {title: "Square Feet",color:"#8C7853"},
		'hAxis': {title: "Year",color:"#8C7853"},
		'legend': 'none',
		'width' : '500px'
	  },
	  'view': {'columns':[1,2]}}
	  );
	  
	  //Table
	   // Define a table
		var table1 = new google.visualization.ChartWrapper(
		{
		'chartType': 'Table',
		'containerId': 'table_div',
		'options': {
		'width': '800px',
		'height' : '300px',
		'page' :'enable',
		'pagesize': 8,
		'pagingSymbols' : {prev: 'prev', next: 'next'},
		'pagingButtonsConfiguration' : 'auto'
		}
		});
		
		//ScatterCHarts
		var comboCharts = new google.visualization.ChartWrapper(
		{
		'chartType' : 'ScatterChart',
		'containerId' : 'comboChart_div',
		'isStacked' : 'false',
		'view': { 'columns': [1,3,5,6] },
		'options':{'title':'Story, Bath, Fireplaces Vs Duration',
		'vAxis': {title: "Square Feet",color:"#8C7853"},
		'hAxis': {title: "Year",color:"#8C7853"}
		},
		
		}
		)
	  
		
		  
	  
	  //adding control
	  var Year_Slider = new google.visualization.ControlWrapper({
    'controlType': 'NumberRangeFilter',
    'containerId': 'filter_div',
    'options': {
      'filterColumnIndex': 1,
      'minValue': 1909,
      'maxValue': 2003
    },
    // Explicitly positions the thumbs at position 1909 and 2003,
    'state': {'lowValue': 1909, 'highValue': 2003}
  });
  
   // Define a category picker for the 'Bath' column in CHart 3.
  var categoryPicker_Bath = new google.visualization.ControlWrapper({
    'controlType': 'CategoryFilter',
    'containerId': 'categoryBath_div',
    'options': {
      'filterColumnIndex': 5,
      'ui': {
        'allowTyping': false,
        'allowMultiple': true,
        'selectedValuesLayout': 'aboveStacked'
      }
    },
    // Define an initial state, i.e. a set of metrics to be initially selected.
    'state': {'selectedValues': [1,1.5,2,2.5,3]}
  });
  
  // Define a category picker for the 'Story' column in CHart 3.
  var categoryPicker_story = new google.visualization.ControlWrapper({
    'controlType': 'CategoryFilter',
    'containerId': 'categoryStory_div',
    'options': {
      'filterColumnIndex': 3,
      'ui': {
        'allowTyping': false,
        'allowMultiple': true,
        'selectedValuesLayout': 'aboveStacked'
      }
    },
    // Define an initial state, i.e. a set of metrics to be initially selected.
    'state': {'selectedValues': [1,1.5,1.75,2,2.5]}
  });
  // Define a category picker for the 'FirePlace' column in CHart 3.
  var categoryPicker_FirePlace = new google.visualization.ControlWrapper({
    'controlType': 'CategoryFilter',
    'containerId': 'categoryFirePlace_div',
    'options': {
      'filterColumnIndex': 6,
      'ui': {
        'allowTyping': false,
        'allowMultiple': true,
        'selectedValuesLayout': 'aboveStacked'
      }
    },
    // Define an initial state, i.e. a set of metrics to be initially selected.
    'state': {'selectedValues': [0,1,2]}
  });
  
  
	  //Establishing Dependencies
	   dashboard.bind(Year_Slider, [LineChart1,table1,comboCharts]);
	    dashboard.bind(categoryPicker_Bath,comboCharts);
	   dashboard.bind(categoryPicker_story,comboCharts);
	   dashboard.bind(categoryPicker_FirePlace,comboCharts)
	  
	  dashboard.draw(data);
	  
	  //DRAW STEOCHART
	  
	 var data = response.getDataTable();
	 var rows_count=response.getDataTable().getNumberOfRows();
	 var col_count=response.getDataTable().getNumberOfColumns();
	 var Main_Data=new google.visualization.DataTable();
	 Main_Data.addColumn('string','Year');
	 Main_Data.addColumn('number','Land Cost');
	 Main_Data.addColumn('number','Building Cost');
	 
	 for(var i=0;i<rows_count;i++)
	 {
	 var row_data=[''+data.getValue(i, 1)+'',data.getValue(i, 8),data.getValue(i,9)];
	 Main_Data.addRow(row_data);
	 }
	
	 var chart = new google.visualization.SteppedAreaChart(document.getElementById('motionChart_div'));
        chart.draw(Main_Data, {title:'Land, Building Cost Vs Area', vAxis:{title: 'Square Feet'},hAxis:{title: 'Year'},width:600,height:400});
	 
	  
	  
    }
	
	
	
    }
    
   
	

    
    </script>
  </head>
  <body style="font-family: Arial;border: 0 none;">
  <div id="dashboard_div">
  <table border="1" style="width:100%">
  <tr>
  <td style="width:10%,height:100%"></td>
  <td style="width:90%,height:100%"><div id="filter_div"></div></td>
  </tr>
  <tr>
  <td style="width:10%,height:100%"><pre>Shows all the data 
  Present in the Spreadsheet</pre></td>
  <td style="width:90%,height:100%"><div id="table_div" style="float:left;"></div></td>
  </tr>
  <tr>
  <td style="width:10%,height:100%"><pre>Variation of Building 
  area with Duration</pre></td>
  <td style="width:90%,height:100%"><div id="visualization1_div" style="height: 400px; width: 60%; float:left"></div></td>
  </tr>
  <tr>
  <td style="width:10%,height:100%"><pre>Variation in Number of 
  Stories, Baths and Fireplace 
  with Duration</pre></td>
  <td style="width:90%,height:100%">
  <div id="categoryBath_div"></div>
	<div id="categoryStory_div"></div>
	<div id="categoryFirePlace_div"></div>
  <div id="comboChart_div" style="float:left;width: 100%;"></div>
  </td>
  </tr>
  <tr>
  <td style="width:10%,height:100%"><pre>Variation of Land and 
  Building cost with 
  Duration (The Year filter 
  doesnot work for 
  the given Graph)</pre></td>
  <td style="width:90%,height:100%"><div id="motionChart_div"></div></td>
  </tr>
  </table>
    </div>
  </body>
</html>
?